files = dir('*.csv');

place = [];
win = [];
for j=1:365

    P = readtable(files(j).name);
    
    W = readtable(files((j+365)).name);
    
    win = [win; W.EVENT_ID, W.SELECTION_ID, W.BSP, W.PPWAP, W.PPMAX, W.PPTRADEDVOL, W.IPTRADEDVOL];
    place = [place; P.EVENT_ID, P.SELECTION_ID, P.BSP,P.PPWAP, P.PPMAX, P.PPTRADEDVOL, P.IPTRADEDVOL];

end

lia = ismember(win(:,2),place(:,2));


win(find(lia==0),:) = [];

win = sortrows(win,[2,1]);
place = sortrows(place,[2,1]);


win(113,:) = [];win(159,:) = [];win(203,:) = [];win(605,:) = [];
win(702,:) = [];win(807,:) = [];win(849,:) = [];win(851,:) = [];
win(851,:) = [];win(851,:) = [];win(1032,:) = [];win(1683,:) = [];
win(1818,:) = [];win(1925,:) = [];win(1946,:) =[];win(2051,:) = [];
win(2191,:) = [];win(2243,:) = [];win(2299,:) = [];win(2371,:) = [];
win(2413,:) = [];win(2493,:) = [];win(2716,:) = [];win(2816,:) = [];
win(2918,:) = [];win(3135,:) = [];win(3412,:) = [];win(3510,:) = [];
win(3516,:) = [];win(3624,:) = [];win(4139,:) = [];win(4168,:) = [];
win(4268,:) = [];win(4274,:) = [];win(4360,:) = [];win(4374,:) = [];
win(4449,:) = [];win(4512,:) = [];win(4626,:) = [];win(4998,:) = [];
win(5349,:) = [];win(5350,:) = [];win(5460,:) = [];win(5773,:) = [];
win(5881,:) = [];win(6056,:) = [];win(6136,:) = [];win(6221,:) = [];
win(6301,:) = [];win(6565,:) = [];win(6877,:) = [];win(7086,:) = [];
win(7131,:) = [];win(7474,:) = [];win(7536,:) = [];win(7873,:) = [];
win(7905,:) = [];win(8260,:) = [];win(8279,:) = [];win(8360,:) = [];
win(8368,:) = [];win(8426,:) = [];win(8552,:) = [];win(8619,:) = [];
win(8829,:) = [];win(8896,:) = [];win(9202,:) = [];win(9245,:) = [];
win(9298,:) = [];win(9415,:) = [];win(9487,:) = [];win(9623,:) = [];
win(9691,:) = [];win(9779,:) = [];win(9798,:) = [];win(9887,:) = [];
win(9891,:) = [];win(9984,:) = [];win(10054,:) = [];win(10074,:) = [];
win(10396,:) = [];win(10569,:) = [];win(10614,:) = [];win(10750,:) = [];
win(10816,:) = [];win(10989,:) = [];win(11174,:) = [];win(11186,:) = [];
win(11188,:) = [];win(11437,:) = [];win(11771,:) = [];win(12036,:) = [];
win(12039,:) = [];win(12052,:) = [];win(12141,:) = [];win(12142,:) = [];
win(12182,:) = [];win(12461,:) = [];win(12541,:) = [];win(12555,:) = [];
win(12603,:) = [];win(12618,:) = [];win(12744,:) = [];win(12898,:) = [];
win(13009,:) = [];win(13085,:) = [];win(13251,:) = [];win(13667,:) = [];
win(14033,:) = [];win(14090,:) = [];win(14188,:) = [];win(14246,:) = [];
win(14254,:) = [];win(14663,:) = [];win(14697,:) = [];win(14882,:) = [];
win(14887,:) = [];win(14983,:) = [];win(15028,:) = [];win(15367,:) = [];
win(15404,:) = [];win(15462,:) = [];win(15535,:) = [];win(15792,:) = [];
win(15897,:) = [];win(15929,:) = [];win(15942,:) = [];win(16072,:) = [];
win(16460,:) = [];win(16466,:) = [];win(16647,:) = [];win(16774,:) = [];
win(16780,:) = [];win(17054,:) = [];win(17093,:) = [];win(17095,:) = [];
win(17165,:) = [];win(17333,:) = [];win(17442,:) = [];win(17841,:) = [];
win(17926,:) = [];win(17939,:) = [];win(17999,:) = [];win(18048,:) = [];
win(18110,:) = [];win(18389,:) = [];win(18414,:) = [];win(18464,:) = [];
win(18542,:) = [];win(18555,:) = [];win(18556,:) = [];win(18944,:) = [];
win(19139,:) = [];win(19309,:) = [];win(19357,:) = [];win(19629,:) = [];
win(19730,:) = [];win(19884,:) = [];win(19889,:) = [];win(20279,:) = [];
win(20351,:) = [];win(20390,:) = [];win(20882,:) = [];win(21095,:) = [];
win(21120,:) = [];win(21185,:) = [];win(21230,:) = [];win(21324,:) = [];
win(21324,:) = [];win(21462,:) = [];win(21575,:) = [];win(21604,:) = [];
win(21611,:) = [];win(21800,:) = [];win(21895,:) = [];win(21924,:) = [];
win(22048,:) = [];win(22145,:) = [];win(22158,:) = [];win(22294,:) = [];
win(22295,:) = [];win(22319,:) = [];win(22377,:) = [];win(22379,:) = [];
win(22395,:) = [];win(22403,:) = [];win(22528,:) = [];win(22592,:) = [];
win(22955,:) = [];win(23028,:) = [];win(23043,:) = [];win(23096,:) = [];
win(23235,:) = [];win(23450,:) = [];win(23552,:) = [];win(23577,:) = [];
win(23641,:) = [];win(23788,:) = [];win(23958,:) = [];win(24065,:) = [];
win(24161,:) = [];win(24215,:) = [];win(24222,:) = [];win(24277,:) = [];
win(24289,:) = [];win(24324,:) = [];win(24425,:) = [];win(24435,:) = [];
win(24635,:) = [];win(24639,:) = [];win(24805,:) = [];win(25004,:) = [];
win(25209,:) = [];win(25461,:) = [];win(25556,:) = [];win(25622,:) = [];
win(25951,:) = [];win(25998,:) = [];win(26044,:) = [];win(26044,:) = [];
win(26046,:) = [];win(26063,:) = [];win(26092,:) = [];win(26371,:) = [];
win(27383,:) = [];win(27397,:) = [];win(27397,:) = [];win(27616,:) = [];
win(27657,:) = [];win(27662,:) = [];win(27775,:) = [];win(27784,:) = [];
win(27819,:) = [];win(27820,:) = [];win(27942,:) = [];win(28069,:) = [];
win(28086,:) = [];win(28093,:) = [];win(28131,:) = [];win(28407,:) = [];
win(28814,:) = [];win(28872,:) = [];win(28886,:) = [];win(28904,:) = [];
win(28911,:) = [];win(29048,:) = [];win(29206,:) = [];win(29365,:) = [];
win(29450,:) = [];win(29635,:) = [];win(29659,:) = [];win(29662,:) = [];
win(29662,:) = [];win(29687,:) = [];win(29775,:) = [];win(30097,:) = [];
win(30178,:) = [];win(30329,:) = [];win(30347,:) = [];win(30423,:) = [];
win(30494,:) = [];win(30501,:) = [];win(30640,:) = [];win(30641,:) = [];
win(30658,:) = [];win(30659,:) = [];win(30783,:) = [];win(30783,:) = [];
win(30926,:) = [];win(30926,:) = [];win(31023,:) = [];win(31441,:) = [];
win(31489,:) = [];win(31490,:) = [];win(31510,:) = [];win(31536,:) = [];
win(31615,:) = [];win(31682,:) = [];win(31853,:) = [];win(31953,:) = [];
win(31968,:) = [];win(31968,:) = [];win(32091,:) = [];win(32406,:) = [];
win(32427,:) = [];win(32532,:) = [];win(32650,:) = [];win(32712,:) = [];
win(32726,:) = [];win(32951,:) = [];win(33093,:) = [];win(33102,:) = [];
win(33172,:) = [];win(33207,:) = [];win(33272,:) = [];win(33381,:) = [];
win(33507,:) = [];win(33548,:) = [];win(33881,:) = [];win(33999,:) = [];
win(34007,:) = [];win(34261,:) = [];win(34317,:) = [];win(34840,:) = [];
win(34867,:) = [];win(35275,:) = [];win(35370,:) = [];win(35544,:) = [];
win(35595,:) = [];win(35891,:) = [];win(35923,:) = [];win(35926,:) = [];
win(35939,:) = [];win(35973,:) = [];win(36430,:) = [];win(36465,:) = [];
win(36466,:) = [];win(36589,:) = [];win(36819,:) = [];win(36833,:) = [];
win(36943,:) = [];win(36950,:) = [];win(37068,:) = [];win(37267,:) = [];
win(37333,:) = [];win(37404,:) = [];win(37628,:) = [];win(37956,:) = [];
win(38070,:) = [];win(38109,:) = [];win(38110,:) = [];win(38113,:) = [];
win(38114,:) = [];win(38266,:) = [];win(38429,:) = [];win(38446,:) = [];
win(38484,:) = [];win(38604,:) = [];win(38658,:) = [];win(38677,:) = [];
win(38695,:) = [];win(38741,:) = [];win(38748,:) = [];win(38806,:) = [];
win(38835,:) = [];win(38937,:) = [];win(38955,:) = [];win(39001,:) = [];
win(39197,:) = [];win(39219,:) = [];win(39248,:) = [];win(39262,:) = [];
win(39318,:) = [];win(39318,:) = [];win(39354,:) = [];win(39369,:) = [];
win(39370,:) = [];win(39418,:) = [];win(39421,:) = [];win(39477,:) = [];
win(39505,:) = [];win(39537,:) = [];win(39537,:) = [];win(39537,:) = [];
win(39611,:) = [];win(39771,:) = [];win(39882,:) = [];win(39934,:) = [];
win(40109,:) = [];win(40115,:) = [];win(40127,:) = [];win(40127,:) = [];
win(40129,:) = [];win(40129,:) = [];win(40131,:) = [];win(40484,:) = [];
win(40488,:) = [];win(40491,:) = [];win(40571,:) = [];win(40873,:) = [];
win(40951,:) = [];win(41136,:) = [];win(41437,:) = [];win(41446,:) = [];
win(41527,:) = [];win(41616,:) = [];win(41684,:) = [];win(41983,:) = [];
win(42028,:) = [];win(42150,:) = [];win(42210,:) = [];win(42263,:) = [];
win(42264,:) = [];win(42294,:) = [];win(42330,:) = [];win(42441,:) = [];
win(42562,:) = [];win(42636,:) = [];win(42729,:) = [];win(42813,:) = [];
win(42871,:) = [];win(43061,:) = [];win(43541,:) = [];win(43714,:) = [];
win(43973,:) = [];win(44182,:) = [];win(44452,:) = [];win(44807,:) = [];
win(44814,:) = [];win(45175,:) = [];win(45502,:) = [];win(45903,:) = [];
win(45974,:) = [];win(46034,:) = [];win(46054,:) = [];win(46217,:) = [];
win(46494,:) = [];win(46740,:) = [];win(46780,:) = [];win(46893,:) = [];
win(46993,:) = [];win(47354,:) = [];win(47700,:) = [];win(47841,:) = [];
win(47899,:) = [];win(47907,:) = [];win(47987,:) = [];win(48122,:) = [];
win(48168,:) = [];win(48304,:) = [];win(48349,:) = [];win(48553,:) = [];
win(48572,:) = [];win(48603,:) = [];win(48790,:) = [];win(48813,:) = [];
win(48942,:) = [];win(48942,:) = [];win(48952,:) = [];win(49005,:) = [];
win(49038,:) = [];win(49216,:) = [];win(49234,:) = [];win(49305,:) = [];
win(49319,:) = [];win(49428,:) = [];win(49429,:) = [];win(49491,:) = [];
win(49501,:) = [];win(49573,:) = [];win(49573,:) = [];win(49590,:) = [];
win(49890,:) = [];win(49955,:) = [];win(50287,:) = [];win(50297,:) = [];
win(50341,:) = [];win(50388,:) = [];win(50434,:) = [];win(50467,:) = [];
win(50598,:) = [];win(50823,:) = [];win(50830,:) = [];win(50883,:) = [];
win(50922,:) = [];win(50944,:) = [];win(50944,:) = [];win(51109,:) = [];
win(51185,:) = [];win(51297,:) = [];win(51344,:) = [];win(51432,:) = [];
win(51596,:) = [];win(51619,:) = [];win(51741,:) = [];win(51779,:) = [];
win(51779,:) = [];win(51783,:) = [];win(51783,:) = [];win(51783,:) = [];
win(51783,:) = [];win(51830,:) = [];win(51914,:) = [];win(51991,:) = [];
win(52440,:) = [];win(52520,:) = [];win(52709,:) = [];win(52960,:) = [];
win(53011,:) = [];win(53014,:) = [];win(53038,:) = [];win(53069,:) = [];
win(53168,:) = [];win(53409,:) = [];win(53418,:) = [];win(53632,:) = [];
win(53732,:) = [];win(53793,:) = [];win(53823,:) = [];win(54002,:) = [];
win(54069,:) = [];win(54079,:) = [];win(54086,:) = [];win(54375,:) = [];
win(54454,:) = [];win(54506,:) = [];win(54681,:) = [];win(54740,:) = [];
win(54876,:) = [];win(54954,:) = [];win(55312,:) = [];win(55367,:) = [];
win(55489,:) = [];win(55491,:) = [];win(55498,:) = [];win(55649,:) = [];
win(55653,:) = [];win(55684,:) = [];win(55817,:) = [];win(56024,:) = [];
win(56062,:) = [];win(56278,:) = [];win(56292,:) = [];win(56533,:) = [];
win(56570,:) = [];win(56613,:) = [];win(56861,:) = [];win(57102,:) = [];
win(57105,:) = [];win(57106,:) = [];win(57329,:) = [];win(57649,:) = [];
win(57994,:) = [];win(58118,:) = [];win(58322,:) = [];win(58462,:) = [];
win(58463,:) = [];win(58465,:) = [];win(58467,:) = [];win(58514,:) = [];
win(58652,:) = [];win(58714,:) = [];win(58898,:) = [];win(59127,:) = [];
win(59165,:) = [];win(59298,:) = [];win(59327,:) = [];win(59810,:) = [];
win(60195,:) = [];win(60286,:) = [];win(60619,:) = [];win(60641,:) = [];
win(60965,:) = [];win(61012,:) = [];win(61070,:) = [];win(61122,:) = [];
win(61358,:) = [];win(61542,:) = [];win(61560,:) = [];win(61602,:) = [];
win(61889,:) = [];win(61921,:) = [];win(62017,:) = [];win(62146,:) = [];
win(62451,:) = [];win(62764,:) = [];win(63066,:) = [];win(63379,:) = [];
win(63763,:) = [];win(63767,:) = [];win(63839,:) = [];win(64025,:) = [];
win(64173,:) = [];win(64301,:) = [];win(64345,:) = [];win(64470,:) = [];
win(64489,:) = [];win(64555,:) = [];win(64811,:) = [];win(64951,:) = [];
win(64954,:) = [];win(64954,:) = [];win(65059,:) = [];win(65097,:) = [];
win(65373,:) = [];win(65386,:) = [];win(65411,:) = [];win(65564,:) = [];
win(65565,:) = [];win(65606,:) = [];win(65607,:) = [];win(65650,:) = [];
win(65897,:) = [];win(66249,:) = [];win(66274,:) = [];win(66331,:) = [];
win(66493,:) = [];win(66512,:) = [];win(66551,:) = [];win(66620,:) = [];
win(66635,:) = [];win(67075,:) = [];win(67112,:) = [];win(67112,:) = [];
win(67188,:) = [];win(67438,:) = [];win(67524,:) = [];win(67697,:) = [];
win(67766,:) = [];win(67802,:) = [];win(67825,:) = [];win(67890,:) = [];
win(67971,:) = [];win(68223,:) = [];win(68473,:) = [];win(68484,:) = [];
win(68556,:) = [];win(68563,:) = [];win(68569,:) = [];win(68782,:) = [];
win(68813,:) = [];win(68899,:) = [];win(69046,:) = [];win(69141,:) = [];
win(69149,:) = [];win(69150,:) = [];win(69205,:) = [];win(69272,:) = [];
win(69402,:) = [];win(69431,:) = [];win(69499,:) = [];win(69715,:) = [];
win(69724,:) = [];win(69757,:) = [];win(69832,:) = [];win(69918,:) = [];
win(70068,:) = [];win(70369,:) = [];win(70407,:) = [];win(70409,:) = [];
win(70514,:) = [];win(70514,:) = [];win(70888,:) = [];win(70965,:) = [];
win(70967,:) = [];win(70970,:) = [];win(71261,:) = [];win(71800,:) = [];
win(71800,:) = [];win(72068,:) = [];win(72173,:) = [];win(72884,:) = [];
win(73301,:) = [];win(73926,:) = [];win(74128,:) = [];win(74535,:) = [];
win(74566,:) = [];win(74820,:) = [];win(74901,:) = [];win(75126,:) = [];
win(75434,:) = [];win(75584,:) = [];win(75796,:) = [];win(76069,:) = [];
win(76079,:) = [];win(76198,:) = [];win(76499,:) = [];win(76673,:) = [];
win(76722,:) = [];win(76791,:) = [];win(77191,:) = [];win(77230,:) = [];
win(77240,:) = [];win(77294,:) = [];win(77414,:) = [];win(77692,:) = [];
win(77780,:) = [];win(77800,:) = [];win(77836,:) = [];win(77885,:) = [];
win(77901,:) = [];win(77913,:) = [];win(78137,:) = [];win(78163,:) = [];
win(78274,:) = [];win(78438,:) = [];win(78446,:) = [];win(78551,:) = [];
win(78605,:) = [];win(78988,:) = [];win(79031,:) = [];win(79118,:) = [];
win(79274,:) = [];win(79310,:) = [];win(79329,:) = [];win(79406,:) = [];
win(79481,:) = [];win(79517,:) = [];win(79640,:) = [];win(79674,:) = [];
win(79792,:) = [];win(79833,:) = [];win(79845,:) = [];win(80107,:) = [];
win(80406,:) = [];win(80414,:) = [];win(80773,:) = [];win(80939,:) = [];
win(80956,:) = [];win(80960,:) = [];win(80962,:) = [];win(80963,:) = [];
win(80967,:) = [];win(80970,:) = [];win(80974,:) = [];win(80979,:) = [];
win(80980,:) = [];win(81064,:) = [];win(81406,:) = [];win(81450,:) = [];
win(81692,:) = [];win(82551,:) = [];win(82841,:) = [];win(83330,:) = [];
win(83658,:) = [];win(84325,:) = [];win(84359,:) = [];win(84812,:) = [];
win(84951,:) = [];win(85209,:) = [];


place(175,:) = [];place(2852,:) = [];place(3419,:) = [];place(3971,:) = [];
place(4132,:) = [];place(4635,:) = [];place(4808,:) = [];place(5277,:) = [];
place(5567,:) = [];place(5690,:) = [];place(7531,:) = [];place(9117,:) = [];
place(9714,:) = [];place(10807,:) = [];place(10826,:) = [];place(11093,:) = [];
place(11136,:) = [];place(11212,:) = [];place(11404,:) = [];place(11439,:) = [];
place(11864,:) = [];place(12621,:) = [];place(12650,:) = [];place(12731,:) = [];
place(13916,:) = [];place(15056,:) = [];place(15452,:) = [];place(15474,:) = [];
place(15679,:) = [];place(15913,:) = [];place(16051,:) = [];place(16549,:) = [];
place(16601,:) = [];place(16775,:) = [];place(17008,:) = [];place(17039,:) = [];
place(17464,:) = [];place(18395,:) = [];place(18833,:) = [];place(19033,:) = [];
place(19054,:) = [];place(19095,:) = [];place(20984,:) = [];place(21150,:) = [];
place(21172,:) = [];place(21317,:) = [];place(21791,:) = [];place(21998,:) = [];
place(22085,:) = [];place(22788,:) = [];place(23444,:) = [];place(23745,:) = [];
place(23882,:) = [];place(24090,:) = [];place(24521,:) = [];place(24844,:) = [];
place(25375,:) = [];place(25539,:) = [];place(27564,:) = [];place(27802,:) = [];
place(27931,:) = [];place(28082,:) = [];place(28405,:) = [];place(28468,:) = [];
place(28953,:) = [];place(29122,:) = [];place(29200,:) = [];place(29854,:) = [];
place(30279,:) = [];place(30507,:) = [];place(31748,:) = [];place(31833,:) = [];
place(32913,:) = [];place(33488,:) = [];place(34886,:) = [];place(34936,:) = [];
place(36455,:) = [];place(37084,:) = [];place(37512,:) = [];place(37538,:) = [];
place(37650,:) = [];place(37923,:) = [];place(38004,:) = [];place(38388,:) = [];
place(38422,:) = [];place(38515,:) = [];place(38634,:) = [];place(38690,:) = [];
place(38695,:) = [];place(38940,:) = [];place(38998,:) = [];place(39143,:) = [];
place(39484,:) = [];place(39494,:) = [];place(39935,:) = [];place(41291,:) = [];
place(41711,:) = [];place(42225,:) = [];place(42702,:) = [];place(42876,:) = [];
place(43989,:) = [];place(45253,:) = [];place(46417,:) = [];place(46489,:) = [];
place(46798,:) = [];place(48468,:) = [];place(48673,:) = [];place(48942,:) = [];
place(49047,:) = [];place(49088,:) = [];place(49424,:) = [];place(49521,:) = [];
place(49573,:) = [];place(49904,:) = [];place(50179,:) = [];place(50336,:) = [];
place(50762,:) = [];place(51192,:) = [];place(51211,:) = [];place(51571,:) = [];
place(51696,:) = [];place(52015,:) = [];place(52119,:) = [];place(52693,:) = [];
place(52840,:) = [];place(52954,:) = [];place(53026,:) = [];place(53679,:) = [];
place(53794,:) = [];place(53794,:) = [];place(54085,:) = [];place(54327,:) = [];
place(54474,:) = [];place(54628,:) = [];place(54699,:) = [];place(54747,:) = [];
place(54873,:) = [];place(55506,:) = [];place(55510,:) = [];place(55799,:) = [];
place(56206,:) = [];place(56483,:) = [];place(56500,:) = [];place(56848,:) = [];
place(57114,:) = [];place(58373,:) = [];place(59005,:) = [];place(59138,:) = [];
place(59155,:) = [];place(59949,:) = [];place(60169,:) = [];place(60695,:) = [];
place(60991,:) = [];place(61226,:) = [];place(61987,:) = [];place(62071,:) = [];
place(62355,:) = [];place(62609,:) = [];place(63520,:) = [];place(65409,:) = [];
place(65752,:) = [];place(65996,:) = [];place(66219,:) = [];place(66328,:) = [];
place(66355,:) = [];place(66605,:) = [];place(66760,:) = [];place(66861,:) = [];
place(66947,:) = [];place(68191,:) = [];place(68688,:) = [];place(69009,:) = [];
place(69152,:) = [];place(69152,:) = [];place(69152,:) = [];place(69437,:) = [];
place(69453,:) = [];place(69604,:) = [];place(69833,:) = [];place(70673,:) = [];
place(72117,:) = [];place(72387,:) = [];place(72450,:) = [];place(72880,:) = [];
place(73090,:) = [];place(73260,:) = [];place(73615,:) = [];place(74921,:) = [];
place(76191,:) = [];place(76287,:) = [];place(76752,:) = [];place(76791,:) = [];
place(76791,:) = [];place(77918,:) = [];place(78071,:) = [];place(78135,:) = [];
place(78864,:) = [];place(80933,:) = [];place(80998,:) = [];place(82096,:) = [];
place(83428,:) = [];place(83613,:) = [];place(83626,:) = [];place(83654,:) = [];
place(83659,:) = [];place(83916,:) = [];place(84116,:) = [];place(84164,:) = [];
place(84230,:) = [];place(84425,:) = [];place(84461,:) = [];place(84635,:) = [];
place(85016,:) = [];place(85111,:) = [];place(85113,:) = [];place(85175,:) = [];
place(85312,:) = [];place(85316,:) = [];place(85489,:) = [];place(85614,:) = [];
place(85614,:) = [];place(85614,:) = [];place(85614,:) = [];place(85614,:) = [];

all = [win(:,1), place(:,1), win(:,2), place(:,2)];

x = win(:,3:end);
y = place(:,3);

[train, test] = dividerand(size(x,1),0.7,0.3);

x_train = x(train,:);
y_train = y(train,:);

x_test = x(test,:);
y_test = y(test,:);


           % number of data samples.
x1_train = [ones(length(x_train),1), x_train];

x1_test = [ones(length(x_test),1), x_test];

b1 = x1_train\y_train;
y_pred_1 = x1_test * b1;
%plot(x,y_pred_1,'DisplayName','non-linear');

MSE_1 = mean((y_pred_1 - y_test).^2);
MSE_avg_1 = mean((mean(y_test) - y_test).^2);
R2_1 = 1 - MSE_1/ MSE_avg_1;



% Model using fitrlinear 

% 'OptimizeHyperparameters','auto' using this to find the optimum lambda
% and lerner
model = fitrlinear(x_train,y_train,'Learner','leastsquares', 'Lambda','auto');

y_pred_2 = predict(model,x_test);

%--- Compute R^2 metric (for training data)
MSE_2 = mean( (y_pred_2 - y_test).^2 ); 
MSE_avg_2 = mean( (mean(y_test) - y_test).^2 );
R2_2 = 1 - MSE_2/ MSE_avg_2;



prob_x_train = 1./x_train;
prob_y_train = 1./y_train;
prob_x_test = 1./x_test;
prob_y_test = 1./y_test;


prob_x1_train = [ones(length(prob_x_train),1), prob_x_train];

prob_x1_test = [ones(length(prob_x_test),1), prob_x_test];

b2 = prob_x1_train\prob_y_train;
y_pred_prob = prob_x1_test * b2;
y_pred_2 = 1./y_pred_prob;

MSE_3 = mean((y_pred_2 - y_test).^2);
MSE_avg_3 = mean((mean(y_test) - y_test).^2);
R2_3 = 1 - MSE_3/ MSE_avg_3;

% using polyfit
R25 = [];
for i = 1:10
m3 = polyfit(x_train(:,1),y_train,i);
y_pred_5 = polyval(m3,x_test(:,1));

MSE_5 = mean((y_pred_5 - y_test).^2);
MSE_avg_5 = mean((mean(y_test) - y_test).^2);
R2_5 = 1 - MSE_5/ MSE_avg_5;
hold on;
scatter(i,R2_5, "red");
R25 = [R25,R2_5];
end

R2_5 = max(R25);
